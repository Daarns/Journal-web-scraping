{% extends "layouts/app_layouts.html" %}


{% block styles %}
{{ super() }}
<link rel="stylesheet" href="{{ url_for('static', path='css/collections.css') }}">
{% endblock %}

{% block content %}
<div class="container-fluid collections-page pt-4 pb-5 px-md-4">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2 class="collections-title mb-0"><i class="fas fa-folder me-2"></i>Koleksi Saya</h2>
        <button class="btn btn-primary create-collection-btn" id="mainCreateCollectionBtn">
            <i class="fas fa-plus"></i> Buat Koleksi
        </button>
    </div>

    <!-- Loading State -->
    <div class="collections-loading-state text-center py-5">
        <div class="spinner-border text-primary" role="status"></div>
        <p class="mt-3">Memuat koleksi...</p>
    </div>

    <!-- Empty State -->
    <div class="collections-empty-state d-none text-center py-5">
        <div class="empty-icon mb-3">
            <i class="fas fa-folder-open fa-4x"></i>
        </div>
        <h4>Belum Ada Koleksi</h4>
        <p class="text-muted mb-4">Mulai buat koleksi untuk menyimpan paper favorit Anda.</p>
        <button class="btn btn-primary create-collection-btn">
            <i class="fas fa-plus"></i> Buat Koleksi Pertama
        </button>
    </div>

    <!-- Collections Grid -->
    <div class="row collections-grid d-none">
        <!-- Collections will be added here -->
    </div>
</div>

<!-- Modal Create/Edit Collection -->
<div class="modal fade" id="collectionFormModal" tabindex="-1" aria-labelledby="collectionFormModalLabel"
    aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="collectionFormModalLabel">Buat Koleksi Baru</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"
                    aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="collectionForm">
                    <input type="hidden" id="collectionId" value="">
                    <div class="mb-3">
                        <label for="collectionName" class="form-label">Nama Koleksi</label>
                        <input type="text" class="form-control bg-dark text-white" id="collectionName" required>
                    </div>
                    <div class="mb-3">
                        <label for="collectionDescription" class="form-label">Deskripsi (opsional)</label>
                        <textarea class="form-control bg-dark text-white" id="collectionDescription"
                            rows="3"></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-outline-light" data-bs-dismiss="modal">Batal</button>
                <button type="button" class="btn btn-primary" id="saveCollectionBtn">Simpan</button>
            </div>
        </div>
    </div>
</div>

<!-- Modal Collection Detail -->
<div class="modal fade" id="collectionDetailModal" tabindex="-1" aria-labelledby="collectionDetailModalLabel"
    aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg modal-dialog-scrollable">
        <div class="modal-content">
            <div class="modal-header">
                <div class="d-flex align-items-center">
                    <div class="collection-icon me-2">
                        <i class="fas fa-folder"></i>
                    </div>
                    <h5 class="modal-title" id="collectionDetailModalLabel">Judul Koleksi</h5>
                </div>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"
                    aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="collection-detail-info">
                    <p class="collection-description"></p>
                    <div class="collection-metadata">
                        <span class="badge bg-primary collection-paper-count">0 paper</span>
                        <span class="collection-created-date">
                             <i class="fas fa-calendar-alt"></i>
                        </span>
                    </div>
                </div>

                <!-- Paper List Loading -->
                <div class="papers-loading text-center py-4">
                    <div class="spinner-border text-primary" role="status"></div>
                    <p class="mt-2">Memuat paper...</p>
                </div>

                <!-- Paper List Empty -->
                <div class="papers-empty d-none text-center py-4">
                    <div class="empty-icon mb-3">
                        <i class="fas fa-file-alt fa-3x text-muted"></i>
                    </div>
                    <h5>Belum Ada Paper</h5>
                    <p class="text-muted mb-3">Koleksi ini masih kosong. Tambahkan paper saat melakukan pencarian.</p>
                    <a href="/search" class="btn btn-outline-primary">Cari Paper</a>
                </div>

                <!-- Papers List -->
                <div class="collection-papers-list d-none"></div>
            </div>
            <div class="modal-footer">
                <div class="d-flex justify-content-between w-100">
                    <div>
                        <button type="button" class="btn btn-outline-danger delete-collection-btn">
                            <i class="fas fa-trash"></i> Hapus Koleksi
                        </button>
                    </div>
                    <div>
                        <button type="button" class="btn btn-outline-info edit-collection-btn me-2">
                            <i class="fas fa-edit"></i> Edit
                        </button>
                        <button type="button" class="btn btn-outline-light" data-bs-dismiss="modal">Tutup</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Modal Confirm Delete -->
<div class="modal fade" id="deleteConfirmModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Konfirmasi Hapus</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"
                    aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p>Apakah Anda yakin ingin menghapus koleksi ini? Semua paper yang tersimpan dalam koleksi ini juga akan
                    dihapus.</p>
                <p class="text-danger fw-bold mb-0">Tindakan ini tidak dapat dibatalkan.</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-outline-light" data-bs-dismiss="modal">Batal</button>
                <button type="button" class="btn btn-danger" id="confirmDeleteBtn">Hapus</button>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block page_scripts %}
<script src="{{ url_for('static', path='js/collection_view.js') }}"></script>
{% endblock %}